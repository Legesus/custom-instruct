---
name: pentester-research
description: Research security topics, generate compliance-mapped security reports, and implement remediation fixes. Use for vulnerability research, security assessments, and applying fixes based on findings.
version: 2.0.0
tags:
  - security
  - research
  - pentesting
  - compliance
  - remediation
---

# Pentester Research Skill

A comprehensive security skill with three operational modes: **Research**, **Security Reporting**, and **Remediation**.

> [!CAUTION]
> **Safety First**: Only test systems you have explicit authorization to test. This skill is for educational and defensive purposes.

---

## Mode 1: Research Mode

Research penetration testing topics, vulnerability mechanics, and exploitation techniques using trusted resources.

### Trusted Resources
Prioritize information from:
- **PortSwigger Web Security Academy** (`portswigger.net`)
- **OWASP** (`owasp.org`)
- **HackTricks** (`book.hacktricks.xyz`)
- **PayloadAllTheThings** (`github.com/swisskyrepo/PayloadsAllTheThings`)
- **GTFOBins** (`gtfobins.github.io`)
- **Rapid7 Database** (`rapid7.com/db`)
- **MITRE ATT&CK / CWE** (`mitre.org`)

### Research Workflow

1. **Analyze Request**: Identify the vulnerability, tool, or concept
2. **Targeted Search**: Use `search_web` with site-specific queries
   ```
   site:portswigger.net [topic]
   site:book.hacktricks.xyz [topic]
   ```
3. **Synthesize Findings** using this structure:
   - **Concept Name**: Brief explanation
   - **Technical Mechanics**: How the vulnerability works
   - **Common Vectors/Payloads**: Representative examples
   - **Detection & Exploitation**: How to identify and verify
   - **Remediation**: How to fix

---

## Mode 2: Security Report Mode

Generate compliance-mapped security reports assessing applications against industry standards.

### Supported Compliance Standards

| Standard | Focus Area | Reference |
|----------|------------|-----------|
| **OWASP Top 10** | Web application vulnerabilities | `owasp.org/Top10` |
| **OWASP ASVS** | Application Security Verification | `owasp.org/asvs` |
| **PCI-DSS v4.0** | Payment card data protection | `pcisecuritystandards.org` |
| **NIST 800-53** | Federal security controls | `nist.gov` |
| **CIS Controls v8** | Critical security baseline | `cisecurity.org` |
| **SANS Top 25** | Dangerous software errors | `sans.org/top25` |

### Report Generation Workflow

1. **Gather Information**
   - Collect findings from the user (vulnerabilities discovered, affected components)
   - Ask for scope, target application name, and assessment dates

2. **Map to Compliance**
   - For each finding, identify applicable standards:
     - CWE ID (Common Weakness Enumeration)
     - OWASP Top 10 category (A01-A10)
     - PCI-DSS requirement (if payment-related)
     - NIST control family (if applicable)

3. **Calculate Risk**
   - Assign CVSS score (use CVSS 3.1 calculator methodology)
   - Determine business impact

4. **Generate Report**
   - Use template: `templates/security_report_template.md`
   - Copy template to user's workspace
   - Fill in all sections with collected data

5. **Provide Compliance Summary**
   - List which controls passed/failed
   - Highlight critical gaps

### Example Usage

**User**: "I found an SQL injection in the login form and weak password policy. Generate a security report."

**Action**:
1. Map SQLi → CWE-89, OWASP A03:2021, PCI-DSS 6.5.1
2. Map Weak Passwords → CWE-521, OWASP A07:2021, PCI-DSS 8.3
3. Copy and populate `security_report_template.md`

---

## Mode 3: Remediation Mode

Implement fixes based on security findings from a report.

### Remediation Workflow

1. **Parse Security Report**
   - User provides path to security report or pastes finding details
   - Extract: vulnerability type, affected component, current code/config

2. **Research Fix**
   - Use Research Mode to find the recommended remediation
   - Prioritize official documentation and OWASP guidance

3. **Generate Fix**
   - For code vulnerabilities: Generate patched code
   - For configuration issues: Generate secure config
   - For missing controls: Generate implementation code

4. **Present for Approval**
   - Show diff of proposed changes
   - Explain what the fix does and why
   - Wait for user approval before applying

5. **Apply Changes**
   - Use file editing tools to implement the fix
   - Log changes in `templates/remediation_log_template.md`

6. **Verify**
   - Suggest verification steps (re-run tests, manual check)
   - Update finding status in remediation log

### Remediation Patterns by Vulnerability Type

| Vulnerability | Typical Remediation |
|--------------|---------------------|
| SQL Injection | Parameterized queries, ORM usage |
| XSS | Output encoding, CSP headers |
| CSRF | Anti-CSRF tokens, SameSite cookies |
| Auth Bypass | Proper session management, MFA |
| Insecure Deserialization | Input validation, allowlists |
| SSRF | URL allowlists, network segmentation |
| Sensitive Data Exposure | Encryption, proper key management |
| Security Misconfiguration | Hardening guides, secure defaults |

### Example Usage

**User**: "Fix the SQL injection in `login.py` from my security report."

**Action**:
1. Read the referenced file
2. Identify the vulnerable query pattern
3. Research parameterized queries for the framework (Flask-SQLAlchemy, raw SQL, etc.)
4. Generate patched code with parameterized query
5. Show diff and get approval
6. Apply fix and log in remediation log

---

## Templates

This skill includes templates in the `templates/` directory:

| Template | Purpose |
|----------|---------|
| `security_report_template.md` | Full security assessment report with compliance mapping |
| `remediation_log_template.md` | Track remediation progress and changes |

---

## Quick Reference

| User Request | Mode | Action |
|-------------|------|--------|
| "How does X vulnerability work?" | Research | Search resources, explain mechanics |
| "Generate a security report for my findings" | Report | Use template, map to compliance |
| "Does this meet PCI-DSS?" | Report | Assess against PCI requirements |
| "Fix the XSS in my code" | Remediation | Generate and apply patch |
| "Remediate all findings from the report" | Remediation | Process each finding systematically |
